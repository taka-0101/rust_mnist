# rust_mnist
Rust勉強のための2層ニューラルネットワークの作成

## Two Layer Net
呼び出す時は二種類の呼び出し方があります。
+ TwoLayerNet::new(入力層サイズ, 中間層サイズ, 出力層サイズ);
+ TwoLayerNet::new_read_weight(重みファイルのパス,入力層サイズ, 中間層サイズ, 出力層サイズ);

Two Layer Net は以下の関数が実装されてます。
+ predict - 入力データに対するニューラルネットワークの出力を返します。
+ write_weight_data - 呼び出された時のネットワークの重みデータを指定されたフォルダに出力します。
+ loss - 交差エントロピー誤差によるloss値を返します。
+ learn - 入力データと教師ラベルを基に勾配法によるパラメーターの更新を行います。

## 入力データと教師ラベル
入力されるデータは、f64の2次元ベクターを入力します。ミニパッチで学習を行うので、入力データは1次元ベクターに変化し、それを格納したベクターで学習を行ってください。

同様に教師ラベルも2次元ベクターです。正解データはone-hot表現を前提にしています。

## 重みデータ
重みデータはそれぞれのパラメーターの値が記述されたtxt形式(例　weight1.txt)で保存、読み込みを行います。TwoLayerNetのwrite_weight_dataはweght1,weght2,biase1,biase2の４つの重みデータを指定のフォルダに保存します。

重みデータの読み込みを行う際は、重みデータが保存してあるPathを引数にしてください。

## 学習
Two Layer Netはlearnによってパラメーターの更新を行います。1回の呼び出しで1回パラメーターの更新を行います。パラメータの更新は勾配法を使って行われます。またlearnはloss値を返します。

## 依存関係
以下の条件で動作確認を行っています。  

rand="0.3.0"  
image = "*"

